<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/bootstrap.min.css"/>
  <script src="searchScript.js"></script>
  <!-- <link rel="stylesheet" href="css/bootstrap-grid.css"/>
  <link rel="stylesheet" href="css/bootstrap.css"/>
  <link rel="stylesheet" href="css/bootstrap.rtl.css"/>
  <link rel="stylesheet" href="css/bootstrap.rtl.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-grid.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-grid.rtl.css"/>
  <link rel="stylesheet" href="css/bootstrap-grid.rtl.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-reboot.css"/>
  <link rel="stylesheet" href="css/bootstrap-reboot.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-reboot.rtl.css"/>
  <link rel="stylesheet" href="css/bootstrap-reboot.rtl.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-utilities.css"/>
  <link rel="stylesheet" href="css/bootstrap-utilities.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-utilities.rtl.css"/>
  <link rel="stylesheet" href="css/bootstrap-utilities.rtl.min.css"/> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"/> 
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css"/>   
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.bootstrap5.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/dataTables.jqueryui.min.css"/> 
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/scroller/2.0.3/css/scroller.jqueryui.min.css"/>   
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/material-components-web/4.0.0/material-components-web.min.css"/>   
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/dataTables.material.min.css"/>   
  
  <link href="https://cdn.rawgit.com/westonganger/bootstrap-directional-buttons/master/dist/bootstrap-directional-buttons.css" rel="stylesheet" type="text/css" />

  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/dataTables.jqueryui.min.js"></script>
  <script src="https://cdn.datatables.net/scroller/2.0.3/js/dataTables.scroller.min.js"></script> 
  <script src="https://cdn.datatables.net/1.10.25/js/dataTables.material.min.js"></script> 
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script> 
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.colVis.min.js"></script> 
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.print.min.js"></script> 
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.html5.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script> 
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.bootstrap5.min.js"></script> 
  <title>CoWin</title>
</head>
<body>
  <header id="home-section">
    <div class="dark-overlay">
      <div class="home-inner container">
        <div class="row">
          <div class="col-lg-8 d-none d-lg-block">
            <h1 class="display-4">Find <strong>Vaccines</strong> by Type, Pincode, Availability by Hospitals
            </h1>
            <div class="d-flex">
              <div class="p-4 align-self-start">
                <!-- <i class="fas fa-check fa-2x"></i> -->
              </div>
              <div class="p-4 align-self-end">
                <!-- Lorem ipsum dolor sit, amet consectetur adipisicing elit. Sed, tempore iusto in minima facere dolorem! -->
              </div>
            </div>

          </div>

          <div class="col-lg-4">
            <div class="card bg-primary text-center card-form">
              <div class="card-body">
                <h3>Search By State and City</h3>
                <form>
                  <div class="input-group mb-3">
                    <select class="form-control" id="locality-dropdown" name="state" onchange="loadSelectedState(this.value)">                               
                    </select>
                  </div>
                  <div class="input-group mb-3">
                    <select class="form-control" id="district-dropdown" name="district">
               
                    </select>
                  </div> 
                  <input type="submit" value="Search" id="btnSearch" class="btn btn-outline-light btn-block">

                  <!-- <p style="color: #ffffff;">Note:The slots availability displayed in the search is provided by the state govt and private hospitals. The total availability slots includes Dose-1 and Dose-2 allotted slots. While we have real-time data, slot availability on the portal changes rapidly. D1: Dose 1, D2: Dose 2</p> -->
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <section id="create-head-section">
    <div class="container">
      <div class="row">
        <div class="col text-center py-5">
        <div id="container" style="display:none"></div>
      </div>
        <!-- <div class="col text-center py-5">
          <h1 class="display-4">Create</h1>
          <p class="lead"><button type="button" value="Dates"></p>
          <a href="#" class="btn btn-outline-light">Find Out More</a>
        </div> -->
        <table id="example" class="mdl-data-table" style="width:100%">
          <thead>
              <tr>
                  <th>Hospital Name</th>
                  <th>Pincode</th>
                  <th>Covishield</th> 
                  <th>Covaxin</th>
                  <th>Sputnik</th>
                  <th>Price</th>  
              </tr>
          </thead>
           <tbody> 
          
           </tbody>
        </table>
      </div>
    </div>
  </section>
  <script src="js/bootstrap.bundle.min.js">
  </script> 
    <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
     ></script>
</body>
</html>

<script>
  $(document).ready(function () {
      var html = "";
      var arrowButton = "";
      html="<button type='button' class='btn btn-outline-dark btn-arrow-left bg-primary'>PREV</button>"
      var dt = new Date(); 
      for (i = 0 ; i < 7 ; i++){
      var date,month; 
      date=dt.getDate()+i;
      month=dt.getMonth()+1;
      html += "<button class='btn btn-outline-light btn-block bg-primary text-center' value="+date+"-"+month+"-"+dt.getFullYear()+">"+date+"-"+month+"-"+dt.getFullYear()+"</button>";            
            
    }
    arrowButton="<button type='button' class='btn btn-outline-dark btn-arrow-right bg-primary'>NEXT</button>"
    html+=arrowButton;
    $("#container").html(html);


    $("button").click(function() {
    var fired_button = $(this).val();
    // alert(fired_button);
});
     $('#example').DataTable({
                  

                ajax: {
                    url: 'https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id=512&date=31-05-2021',
                    dataSrc: "sessions"
                },   
                columnDefs: [ {
                      targets: [ 0 ],
                      orderData: [ 0, 1 ]
                  }, {
                      targets: [ 1 ],
                      orderData: [ 1, 0 ]
                  }, {
                      targets: [ 4 ],
                      orderData: [ 4, 0 ]
                  } ],
                columns: [
                    { data: 'name'},
                    { data: 'pincode' },
                    { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'COVISHIELD') {
                          
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  },
                  { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'COVAXIN') {
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  },
                  { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'SPUTNIK') {
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  }, 
                    {data: 'fee' } 
                ],
                "pageLength": 10
            });

          $("#btnSearch").on("click", function (e) {
          e.preventDefault(); 
          
          let droValue=document.getElementById("district-dropdown").value;
          var today = new Date();
          var date = today.getDate()+'-'+(today.getMonth()+1)+'-'+today.getFullYear();
          if(droValue!=""){ 
            $("#container").show();
          //const disurl = 'https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id='+droValue+'&'+'date'+'='+date;
          $("#example").DataTable().destroy();

          $('#example').DataTable({
                ajax: {
                    url: 'https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id='+droValue+'&'+'date'+'='+date,
                    dataSrc: "sessions"
                },
                columns: [
                { data: 'name', 
                  "render":function(data,type,row){                   
                    return data+" "+row.address;

                  }},
                    { data: 'pincode' },
                    { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'COVISHIELD') {
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  },
                  { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'COVAXIN') {
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  },
                  { data: "available_capacity",
                      "render":function(data,Type,row){
                        if ( row.vaccine === 'SPUTNIK') {
                          return row.available_capacity;}
                          else{
                            return 0;
                          }
                      } 
                  }, 
                    { data: 'fee'}
                     
                ],
                "pageLength": 10
                

            });
          }else{
            alert("Please Choose State and City Values")
          }

          });
          });
</script>
